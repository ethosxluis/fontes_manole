#include "protheus.ch" 

/*
‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±…ÕÕÕÕÕÕÕÕÕÕ—ÕÕÕÕÕÕÕÕÕÕÀÕÕÕÕÕÕÕ—ÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÀÕÕÕÕÕÕ—ÕÕÕÕÕÕÕÕÕÕÕÕÕª±±
±±∫Programa  ≥RODANOW   ∫Autor  ≥Microsiga           ∫ Data ≥  08/10/16   ∫±±
±±ÃÕÕÕÕÕÕÕÕÕÕÿÕÕÕÕÕÕÕÕÕÕ ÕÕÕÕÕÕÕœÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕ ÕÕÕÕÕÕœÕÕÕÕÕÕÕÕÕÕÕÕÕπ±±
±±∫Desc.     ≥                                                            ∫±±
±±∫          ≥                                                            ∫±±
±±ÃÕÕÕÕÕÕÕÕÕÕÿÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕπ±±
±±∫Uso       ≥ AP                                                        ∫±±
±±»ÕÕÕÕÕÕÕÕÕÕœÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕÕº±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂ
*/

user function rodanow()
//Local cQuery := " SELECT A.C5_VTEX, B.C6_NOTA || B.C6_SERIE|| 'FRETE' as C6_NOTA, C5_INVOICE    "
//Local cQuery := " SELECT A.C5_VTEX, B.C6_NOTA || B.C6_SERIE as C6_NOTA, C5_INVOICE    "
Local cQuery := " SELECT A.C5_FILIAL,A.C5_VTEX, B.C6_NOTA || 'FRETE' as C6_NOTA, C5_INVOICE    "
//Local cQuery := " SELECT A.C5_VTEX, B.C6_NOTA as C6_NOTA, C5_INVOICE    "
cQuery += "   FROM SC5010 A, SC6010 B     "
cQuery += "    WHERE A.D_E_L_E_T_ = ' '    "
cQuery += "      AND B.C6_NOTA <> ' '    "
cQuery += "   AND B.C6_NUM = A.C5_NUM    "
cQuery += "   AND B.C6_FILIAL = A.C5_FILIAL    "
cQuery += "      AND B.D_E_L_E_T_ = ' '    "
cQuery += "   AND B.C6_DATFAT between '20201201' and '20210107'"
//cQuery += "      AND A.C5_VTEX in ('1085183148183-01','1078392921460-01','1077891729777-01','1079411868789-01','1078650760034-01','1079461133548-01','1079122988850-01','1079351660766-01')"                                 
//('985483293180-01') "
//cQuery += "      AND A.C5_VTEX in ('842220031100-01','842252677441-01','842261571437-01','842910651197-01','842963061694-01','843112312681-01') "
//cQuery += " 	 AND B.C6_SERIE = '001' "

IiF(SELECT("MNSTVCE")>0,MNSTVCE->(DBCLOSEAREA()),nil)

MemoWrite("rodanow.sql", cQuery)
	
cQuery := ChangeQuery(cQuery)
dbUseArea( .T., "TOPCONN", TCGENQRY(,,cQuery),"MNSTVCE", .T., .T.)
CONOUT("ANALISANDO SE JA TRANSFORMOU OS PEDIDOS FATURADOS EM INVOICED")
WHILE MNSTVCE->(!EOF())
	U_libVtex(alltrim(MNSTVCE->C5_VTEX),alltrim(MNSTVCE->C6_NOTA))
	MNSTVCE->(DBSKIP())
END
RETURN()



/*
cQuery += "      AND A.C5_VTEX in ('851050147224-01','851051787608-01','851052858135-01','851053029641-01','851053408544-01','851241413533-01','851261556464-01','851262387919-01','851262968680-01','851270622908-01','851272851455-01','851292104684-01','851300879757-01','851320197729-01','851331095980-01','851371283837-01','851493480428-01','851512321357-01','851562852728-01','851611746150-01','851613385285-01','851761308867-01','851771242980-01','851781533656-01','851851481092-01', "
cQuery += " '852032465629-01','852092533183-01','852211240072-01','852221232084-01','852222727814-01','852223565214-01','852242503488-01','852262593868-01','852272932774-01','852331495944-01','852332631223-01','852420876595-01','852462583935-01','852682680511-01','852710954725-01','852741582391-01','852743364575-01','852750387637-01','852771795769-01','852820527163-01','852913446642-01','852922668076-01','852940217826-01','852940887758-01','852941716834-01','852950100031-01','852951720777-01', "
cQuery += " '852952337609-01','852970593297-01','853032362632-01','853032368694-01','853032668846-01','853040547522-01','853041668690-01','853050134347-01','853050716316-01','853051390057-01','853062879038-01','853141483426-01','853180951722-01','853181315845-01','853272576640-01','853522471512-01','853523267904-01','853532476870-01','853532477376-01','853533205858-01','853553393724-01','853680843145-01','853690025095-01','853712903759-01','853713196208-01','853713515467-01','853730705650-01', "
cQuery += " '853741621724-01','853761821831-01','853762024735-01','853762599686-01','853770705920-01','853770735390-01','853771183366-01','853781394203-01','853792206304-01','853880471754-01','853900012112-01','853900027466-01','853900272669-01','853900385557-01','853902095132-01','854463560997-01','854502126288-01','854721079316-01','854721883070-01','854750208255-01','854843261903-01','854860684001-01','854873042039-01','854880799921-01','854912679808-01','854953086490-01','854962804106-01', "
cQuery += " '854971395679-01','855123574636-01','855132460343-01','855133205375-01','855141428702-01','855142359747-01','855232826380-01','855252311638-01','855311353053-01','855350702661-01','855361428553-01','855370201607-01','855820692451-01','855821995490-01','855832378457-01','855840068542-01','855850735063-01','855860406704-01','855861068287-01','855862986235-01','855871847677-01','856133314098-01','856140917247-01','856153351275-01','856161115641-01','856161130133-01','856170025424-01', "
cQuery += " '856170463825-01','856181964405-01','856190753737-01','856510982459-01','856573154582-01','857501998343-01','857801972268-01','857832533065-01','858002241402-01','858100194518-01','858102938200-01','858261085024-01','858832097249-01','859091558436-01','859172337612-01','859222145292-01','859292951487-01','859421521639-01','860170660867-01','860173209796-01','860191808480-01','860431184582-01','860610060603-01','860632852834-01','860841011173-01','860891231125-01','861103382026-01', "
cQuery += " '861161872508-01','861411442780-01','861951123280-01','862091530566-01','862111282194-01','862160547206-01','862170084330-01','862300146060-01','862302335346-01','862302917718-01','862303423465-01','862552099265-01','862561977830-01','862582801086-01','862591267991-01','862602738851-01','862612632967-01','862630350667-01','862641725861-01','862641751134-01','862643558828-01','862652467287-01','862752177352-01','862772560123-01','862793271125-01','862800399447-01','862800889729-01', "
cQuery += " '862801034801-01','862802203994-01','862813162840-01','862830610426-01','862831082739-01','862850572842-01','862863359758-01','862870871822-01','862882352122-01','862913249225-01','862982938423-01','863001712979-01','863061782072-01','863082668944-01','863090951273-01','863091426640-01','863122783185-01','863130782878-01','863150197740-01','863153151107-01','863160291167-01','863241366681-01','863242183524-01','863250182329-01','863251201445-01','863251918908-01','863281016316-01', "
cQuery += " '863311241137-01','863311831871-01','863312021284-01','863341854556-01','863360675443-01','863363341522-01','863363434130-01','863363469764-01','863382410366-01','863383334947-01','863462755530-01','863511005350-01','863523580571-01','863563067285-01','863572798890-01','863610779887-01','863613492257-01','863630042531-01','863643381389-01','863681385666-01','863732093773-01','863752886569-01','863760680320-01','863772555647-01','863782949378-01','863791292605-01','863793021111-01', "
cQuery += " '863793412194-01','863830840239-01','863831585415-01','863832831886-01','863842396386-01','863842428952-01','863851642769-01','863862590028-01','863871987175-01','863980499112-01','864002247735-01','864020882591-01','864022480250-01','864093479873-01','864191857803-01','864232272720-01','864272133848-01','864310553058-01','864331810359-01','864342150549-01','864420671792-01','864440334916-01','864451260326-01','864462363573-01','864500270797-01','864501522388-01','864501755065-01', "
cQuery += " '864512058033-01','864532896906-01','864541970291-01','864561591567-01','864563214092-01','864593062499-01','864671828805-01','864713115784-01','864741413968-01','864792711886-01','864821257137-01','864832643850-01','864901717914-01','864910280622-01','864911788157-01','864912193141-01','864913007490-01','864920312691-01','864922389546-01','864942475490-01','864961255256-01','864970521208-01','864982052013-01','864982309901-01','865000073192-01','865013288514-01','865031115429-01', "
cQuery += " '865041657225-01','865062674910-01','865172231258-01','865182691175-01','865210251329-01','865283272879-01','865312736991-01','865320243185-01','865421324690-01','865430729127-01','865512508627-01','865521852421-01','865640699872-01','865640736683-01','865641426859-01','865652045333-01','865652396018-01','865660887061-01','865672422158-01','865673533240-01','865682856781-01','865700217529-01','865701922768-01','865702433375-01','865712377428-01','865720604633-01','865730363041-01', "
cQuery += " '865730991529-01','865731424777-01','865731612555-01','865731750450-01','865740506867-01','865741301631-01','865750437626-01','865751941243-01','865760971080-01','865770964131-01','865771593907-01','865772661476-01','865780789195-01','865781553602-01','865782500359-01','865793534805-01','865802881210-01','865891983938-01','865892630923-01','865892989473-01','865900351106-01','865901301203-01','865902846664-01','865910961367-01','865912077780-01','865921814798-01','865932037474-01', "
cQuery += " '865933598877-01','865940621302-01','865941405872-01','865950804835-01','865951126127-01','865952122001-01','865981810795-01','865990659568-01','865991745998-01','866001269121-01','866010505786-01','866011652503-01','866011961840-01','866012139614-01','866071425014-01','866123068794-01','866143044277-01','866151175994-01','866151990483-01','866180877473-01','866182720053-01','866182755009-01','866193056551-01','866193598662-01','866202583141-01','866211453374-01','866220789040-01', "
cQuery += " '866240370187-01','866243536976-01','866260244458-01','866261209738-01','866261931483-01','866262275966-01','866262534122-01','866332618427-01','866361354056-01','866363121934-01','866372845987-01','866373024370-01','866383247949-01','866390716802-01','866392495400-01','866400504786-01','866420001883-01','866420160258-01','866420238058-01','866420364589-01','866420475371-01','866420568109-01','866432054111-01','866440273790-01','866450557858-01','866451785534-01','866461622230-01', "
cQuery += " '866481842263-01','866490247355-01','866490783923-01','866491073304-01','866501822403-01','866501825474-01','866502019571-01','866502244285-01','866513015140-01','866513025030-01','866592378343-01','866601367862-01','866601718563-01','866603351169-01','866620300548-01','866621004043-01','866621357699-01','866621487476-01','866621594348-01','866621741201-01','866621848868-01','866622441691-01','866630641172-01','866631278161-01','866632901602-01','866642801470-01','866643381483-01', "
cQuery += " '866643597510-01','866651136758-01','866651516890-01','866661689370-01','866661805869-01','866663072945-01','866671955266-01','866673128590-01','866682699636-01','866683499063-01','866690383262-01','866690768425-01','866691965097-01','866702274126-01','866702486622-01','866710082174-01','866713115897-01','866720416247-01','866721416686-01','866730135592-01','866730666121-01','866732813860-01','866742498582-01','866762290686-01','866810397754-01','866820141809-01','866830385559-01', "
cQuery += " '866840700621-01','866842457605-01','866850858171-01','866851069518-01','866852374852-01','866852950154-01','866860380689-01','866861746502-01','866870568318-01','866871080876-01','866871179757-01','866871207205-01','866871324363-01','866871928798-01','866873210250-01','866880521700-01','866882875620-01','866890229695-01','866900428461-01','866902851778-01','866910450667-01','866920630455-01','866920645972-01','866921414225-01','866921839947-01','866922141297-01','866931523398-01', "
cQuery += " '866932332600-01','866932364067-01','866940367993-01','866941992469-01','866942583850-01','866950861806-01','866962065781-01','866962847304-01','866970247428-01','866971896821-01','866971945548-01','866972638147-01','866973238434-01','866993244017-01','867022342559-01','867022813556-01','867061434819-01','867081321723-01','867083175894-01','867090082152-01','867100781262-01','867102568443-01','867103251625-01','867110042323-01','867113206171-01','867120214690-01','867130913391-01', "
cQuery += " '867132862872-01','867140643326-01','867140671341-01','867143454673-01','867152243679-01','867152952529-01','867152967324-01','867160317147-01','867160823024-01','867161484701-01','867161694231-01','867182639669-01','867192509217-01','867192617181-01','867201440316-01','867202067713-01','867202387269-01','867202504724-01','867202703533-01','867211707087-01','867220043335-01','867220272881-01','867220438416-01','867220468716-01','867221599005-01','867221862470-01','867223424556-01', "
cQuery += " '867223545801-01','867242337620-01','867303225352-01','867311718942-01','867320639912-01','867333266185-01','867340454805-01','867340525703-01','867353332395-01','867360639219-01','867362110881-01','867362849461-01','867363480475-01','867370465869-01','867372652508-01','867373313340-01','867373587917-01','867380426142-01','867381486850-01','867382613566-01','867383184908-01','867390040155-01','867390117913-01','867391223468-01','867391878732-01','867392563854-01','867392978270-01', "
cQuery += " '867393039482-01','867393182092-01','867400141365-01','867401697423-01','867410432349-01','867420234353-01','867420278313-01','867422103560-01','867430710516-01','867431900632-01','867432177168-01','867432726834-01','867433499872-01','867441017379-01','867442200078-01','867442491428-01','867443104097-01','867443124639-01','867450069978-01','867452813543-01','867452937179-01','867460462421-01','867460699188-01','867461272879-01','867462363175-01','MZN-701-0470289-8537855','MZN-701-0601923-1039421', "
cQuery += " 'MZN-701-1955017-9825863','MZN-701-2051852-8381864','MZN-701-3310742-4943437','MZN-701-4140878-1714665','MZN-701-4840772-2172200','MZN-701-5093533-7482631','MZN-701-7521546-6859467','MZN-701-9417949-2913851','MZN-702-0209715-4846655','MZN-702-0704928-9890639','MZN-702-0986762-8318606','MZN-702-2819092-0757802','MZN-702-3185243-1709806','MZN-702-3280371-1225024','MZN-702-4697449-7576236','MZN-702-8681297-5078654','MZN-702-9140449-1623401','MZN-702-9560138-0689020','NVP-15094449701','NVP-15167649901', "
cQuery += " 'SKY-LOJAS_AMERICANAS-266837241901','SKY-LOJAS_AMERICANAS-266990698901','SKY-LOJAS_AMERICANAS-267731008001','SKY-LOJAS_AMERICANAS-267737309201','SKY-LOJAS_AMERICANAS-267748719701','SKY-LOJAS_AMERICANAS-267750570501','SKY-LOJAS_AMERICANAS-267752213202','SKY-LOJAS_AMERICANAS-267754606401','SKY-Submarino-350208230502', "
cQuery += " '844621756417-01','844762224071-01','844781124911-01','844781827672-01','844832315167-01','844872892735-01','844891715353-01','844973150507-01','845010517349-01','845580567867-01','845720187485-01','845740328193-01','845743498643-01','845823547529-01','846040588686-01','846051996960-01','846093295352-01','846173119746-01','846202418726-01','846441133070-01','846470415827-01','846471895723-01','847212090467-01','847230186931-01','847411711872-01','847962548119-01','847990650832-01','848131496358-01','848140704851-01','848163069195-01','848192826668-01','848202303842-01','848221332556-01','848232014977-01','848331577762-01','849091755810-01','849100891140-01','849212214833-01','849242898929-01','849342168952-01','849391818838-01','849393409302-01','849421247793-01','849431163420-01','849573322131-01','849581697423-01','849621262806-01','849652175288-01','849680720488-01','849680839610-01','849682861780-01','849701252689-01','849790815173-01','849900984025-01','850143312164-01','850161460043-01','850301223095-01','850373343802-01','850381305377-01','850420093187-01','850532551871-01','850540893668-01','850541576321-01','850552015574-01','850583107190-01','850591428216-01','850592434607-01','850602152099-01','850790845752-01','850791710116-01','850792528556-01','850840234562-01','850890328861-01','851011387286-01','851033198054-01','851042209948-01','851042916245-01', " 
cQuery += " '837320453545-01','837413565989-01','837710037426-01','838092564984-01','838093036683-01','838620931236-01','838621087392-01','838670458941-01','838790923927-01','838793556770-01','838902529051-01','839210200504-01','839272514384-01','839580675581-01','839621095048-01','839631988768-01','839641123611-01','839952440181-01','840572679228-01','840692098712-01','841382693838-01','841953322194-01','841972854071-01','842130568740-01','842143329542-01','842150961104-01','842151906836-01','842170748349-01','842172610270-01','842191251474-01','842200791484-01','842220031100-01','842252677441-01','842261571437-01','842692496243-01','842910651197-01','842963061694-01','843003090284-01','843112312681-01','843180751981-01','843683187331-01','843921943119-01','844111613633-01','844122622701-01','844131164308-01','844331169380-01','844412965527-01','844440961785-01','844570794988-01','844591114097-01', " 
cQuery += " '822431916574-01','822442487208-01','839231317873-01','839303003068-01','839322998698-01','839491022404-01','823721060411-01', '823770052381-01','823882105367-01','824680579361-01','825240290034-01','826283394580-01','827982582982-01','828551245206-01','829023514494-01','829292265265-01','829481420529-01','829700832898-01','829701072344-01','830682600894-01','831170070098-01','831312048775-01','831371564371-01','831403126144-01','832412214641-01','832561326371-01','832563012341-01','832580345086-01','832582757061-01','832592558865-01','832670718323-01','834050844344-01','834220265286-01','834260813155-01','834300527370-01','834483211353-01','834721071040-01','834722437333-01','834911939611-01','835190747762-01','835530774358-01','835622281933-01','835633183699-01','835670417584-01','835880351956-01','835880924137-01','835900686490-01','836201367923-01','836381535774-01','836470827317-01','836783597313-01','837152802473-01','837312477703-01') " 
*/