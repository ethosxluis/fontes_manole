#INCLUDE"RWMAKE.CH"
#INCLUDE"TOPCONN.CH"
USER FUNCTION ACHVNF01()
LOCAL ADOCS := {}
LOCAL CQUERY1 := ""
LOCAL CQUERY2 := ""
LOCAL CQUERY3 := ""

//DADOS DO ARRAY, LISTA DE CHAVES DE NOTAS A SEREM ATUALIZADAS
AADD(ADOCS,{"26120901238035000126550010003883521003883523"})
AADD(ADOCS,{"35120972381189000625550010028185121174584176"})
AADD(ADOCS,{"35120944197044000129550010000327131000376512"})
AADD(ADOCS,{"35120952007010000403550020000201881264111845"})
AADD(ADOCS,{"35120952007010000403550020000201801178626419"})
AADD(ADOCS,{"35120944197044000129550010000327561000377125"})
AADD(ADOCS,{"35120911087261000107550010000643331002685399"})
AADD(ADOCS,{"35120962004395002606550010001043171001993370"})
AADD(ADOCS,{"35120962004395002606550010001043191001993390"})
AADD(ADOCS,{"35120962004395002606550010001043181001993385"})
AADD(ADOCS,{"35120962004395002606550010001043181001993385"})
AADD(ADOCS,{"35120962004395002606550010001043191001993390"})
AADD(ADOCS,{"35120961072898000106550010001102321007001170"})
AADD(ADOCS,{"35120952007010000403550020000204061568414857"})
AADD(ADOCS,{"35121005570714000159550010015506441020728435"})
AADD(ADOCS,{"35121012343506000182550000000006931202372532"})
AADD(ADOCS,{"35121000753648000139550010000028001315092983"})
AADD(ADOCS,{"35121067562884000149550010001193651003805910"})
AADD(ADOCS,{"35121074357062000191550010000015691970150703"})
AADD(ADOCS,{"35121001272874000160550010000005891346208980"})
AADD(ADOCS,{"35121044197044000129550010000330141000480879"})
AADD(ADOCS,{"35121062004395002606550010001045411001995832"})
AADD(ADOCS,{"33121004570097000129550000002694301222462147"})
AADD(ADOCS,{"35121062004395002606550010001046611001997116"})
AADD(ADOCS,{"35121062004395002606550010001046621001997121"})
AADD(ADOCS,{"35121062004395002606550010001046631001997137"})
AADD(ADOCS,{"35121074357062000191550010000015931080060781"})
AADD(ADOCS,{"35121062004395002606550010001047851001998551"})
AADD(ADOCS,{"35121005425121000107550010000040091000094829"})
AADD(ADOCS,{"35121004774358000122550020000389741000389747"})
AADD(ADOCS,{"35121062004395002606550010001048741001999460"})
AADD(ADOCS,{"35121004479137000121550100002157561004535174"})
AADD(ADOCS,{"35121002656953000138550010000364171001786054"})
AADD(ADOCS,{"35121004479137000121550100002161461004842170"})
AADD(ADOCS,{"35121051139335000126550010000029111730686005"})
AADD(ADOCS,{"35121052007010000403550020000213841304426155"})
AADD(ADOCS,{"35121062004395002606550010001050671002001451"})
AADD(ADOCS,{"35121004479137000121550100002171001002623344"})
AADD(ADOCS,{"35121062004395002606550010001051371002002187"})
AADD(ADOCS,{"35121062004395002606550010001051401002002212"})
AADD(ADOCS,{"35121062004395002606550010001051881002002801"})
AADD(ADOCS,{"35121062004395002606550010001052531002003476"})
AADD(ADOCS,{"35121052007010000403550020000220301282813760"})
AADD(ADOCS,{"35121053241071000142550010000036801000036802"})
AADD(ADOCS,{"35121008914167000250550000000439451630758289"})
AADD(ADOCS,{"35121069278455000170550010000114871046403270"})
AADD(ADOCS,{"35121062004395002606550010001055171002006211"})
AADD(ADOCS,{"35121043708379006485550040003106111000000016"})
AADD(ADOCS,{"35121052007010000403550020000225221781304760"})
AADD(ADOCS,{"35121044197044000129550010000337651000492122"})
AADD(ADOCS,{"35121003914408000248550010001844451874334782"})
AADD(ADOCS,{"35121062004395002606550010001057561002008698"})
AADD(ADOCS,{"35121003914408000248550010001844461874334771"})
AADD(ADOCS,{"43121087932463000170550010000625271002858583"})
AADD(ADOCS,{"35121062004395002606550010001058431002009560"})
AADD(ADOCS,{"35121061072898000106550010001142191007001177"})
AADD(ADOCS,{"35121001272874000160550010000006211069005000"})
AADD(ADOCS,{"35121171702716000774550020007124191373654424"})
AADD(ADOCS,{"35121100753648000139550010000029241040714637"})
AADD(ADOCS,{"35121103688545000120550010000155831734587380"})
AADD(ADOCS,{"35121152007010000403550020000231151403116302"})
AADD(ADOCS,{"35121005827094000867550010006645981008988808"})
AADD(ADOCS,{"35121001272874000160550010000006211069005000"})
AADD(ADOCS,{"35121100753648000139550010000029241040714637"})
AADD(ADOCS,{"35121051139335000126550010000029111730686005"})
AADD(ADOCS,{"35121062004395002606550010001045411001995832"})
AADD(ADOCS,{"35121044197044000129550010000330141000480879"})
AADD(ADOCS,{"35121062004395002606550010001046611001997116"})
AADD(ADOCS,{"35121062004395002606550010001046621001997121"})
AADD(ADOCS,{"35121062004395002606550010001046631001997137"})
AADD(ADOCS,{"35121062004395002606550010001047851001998551"})
AADD(ADOCS,{"35121062004395002606550010001048741001999460"})
AADD(ADOCS,{"35121052007010000403550020000213841304426155"})
AADD(ADOCS,{"35121062004395002606550010001050671002001451"})
AADD(ADOCS,{"35121062004395002606550010001051371002002187"})
AADD(ADOCS,{"35121062004395002606550010001051881002002801"})
AADD(ADOCS,{"35121062004395002606550010001052531002003476"})
AADD(ADOCS,{"35121052007010000403550020000220301282813760"})
AADD(ADOCS,{"35121062351341000169550010000575491008112524"})
AADD(ADOCS,{"35121062004395002606550010001055171002006211"})
AADD(ADOCS,{"35121044197044000129550010000337651000492122"})
AADD(ADOCS,{"35121052007010000403550020000225221781304760"})
AADD(ADOCS,{"35121062004395002606550010001057561002008698"})
AADD(ADOCS,{"35121062004395002606550010001058431002009560"})
AADD(ADOCS,{"35121152007010000403550020000231151403116302"})
AADD(ADOCS,{"26121060501293001356550510000052871000052872"})
AADD(ADOCS,{"31120922558670000160550010000220161000220160"})
AADD(ADOCS,{"33120905129326000137550010000006091208090001"})
AADD(ADOCS,{"33120905129326000137550010000006271088000700"})
AADD(ADOCS,{"33121005129326000137550010000006891606950095"})
AADD(ADOCS,{"33121060501293004614550030000019721000019729"})
AADD(ADOCS,{"33121031004013000596550000001498881002032182"})
AADD(ADOCS,{"35120965681033000190550010000014781000014782"})
AADD(ADOCS,{"35121001852291000109550010000011521000011522"})
AADD(ADOCS,{"35121001852291000109550010000011531000011538"})
AADD(ADOCS,{"35121003278714000405550010000078851000360182"})
AADD(ADOCS,{"35121004143345000155550010000279531000279538"})
AADD(ADOCS,{"35121005280707000112550010000001361030904005"})
AADD(ADOCS,{"35121005280707000112550010000001381000030036"})
AADD(ADOCS,{"35121005582701000108550010000224781000224781"})
AADD(ADOCS,{"35121008258596000136550010000084371000084370"})
AADD(ADOCS,{"35121008463170000386550010000271721000271728"})
AADD(ADOCS,{"35121008463170000386550010000271731000271733"})
AADD(ADOCS,{"35121044903391000120550010000038331000038338"})
AADD(ADOCS,{"35121062681033000190550010000015631000015633"})
AADD(ADOCS,{"35120961365284012200550060000330651523543359"})
AADD(ADOCS,{"35120961365284012706550060003871751470081104"})
AADD(ADOCS,{"35120961365284012706550060003873431268050713"})
AADD(ADOCS,{"35120961365284012706550060003890861279470549"})
AADD(ADOCS,{"35120961365284012706550060003891181981580729"})
AADD(ADOCS,{"35120961365284012706550060003891401466114838"})
AADD(ADOCS,{"35120961365284012706550060003891421727974821"})
AADD(ADOCS,{"35120961365284012706550060003891711582849018"})
AADD(ADOCS,{"35120961365284012706550060003891961041752391"})
AADD(ADOCS,{"35120961365284012706550060003892311704830230"})
AADD(ADOCS,{"35120961365284012706550060003895641541345874"})
AADD(ADOCS,{"35120961365284012706550060003897651714466587"})
AADD(ADOCS,{"35120961365284012706550060003898941607558779"})
AADD(ADOCS,{"35120961365284012706550060003899931980720436"})
AADD(ADOCS,{"35120961365284012706550060003900111343723530"})
AADD(ADOCS,{"35120961365284012706550060003900161692377048"})
AADD(ADOCS,{"35120961365284012706550060003901391773893267"})
AADD(ADOCS,{"35120961365284012706550060003904791905683010"})
AADD(ADOCS,{"35120961365284012706550060003908711721274383"})
AADD(ADOCS,{"35120961365284012706550060003925721733543503"})
AADD(ADOCS,{"35120961365284012706550060003925801457730539"})
AADD(ADOCS,{"35120961365284012706550060003926891345471109"})
AADD(ADOCS,{"35120961365284012706550060003926941710373442"})
AADD(ADOCS,{"35120961365284012706550060003929161248136724"})
AADD(ADOCS,{"35120961365284012706550060003932591612137586"})
AADD(ADOCS,{"35121006365284012706550060004020611835522512"})
AADD(ADOCS,{"35121061365284012706550060003957121590879399"})
AADD(ADOCS,{"35121061365284012706550060003957281029313721"})
AADD(ADOCS,{"35121061365284012706550060003964951102983028"})
AADD(ADOCS,{"35121061365284012706550060003965571746360935"})
AADD(ADOCS,{"35121061365284012706550060003966111219991471"})
AADD(ADOCS,{"35121061365284012706550060004013821197754645"})
AADD(ADOCS,{"35121061365284012706550060004013941996273177"})
AADD(ADOCS,{"35121061365284012706550060004014061227051691"})
AADD(ADOCS,{"35121061365284012706550060004014591325380448"})
AADD(ADOCS,{"35121061365284012706550060004014601775312525"})
AADD(ADOCS,{"35121061365284012706550060004014621237376037"})
AADD(ADOCS,{"35121061365284012706550060004014691787446993"})
AADD(ADOCS,{"35121061365284012706550060004014761202250091"})
AADD(ADOCS,{"35121061365284012706550060004014801305212195"})
AADD(ADOCS,{"35121061365284012706550060004014811027877965"})
AADD(ADOCS,{"35121061365284012706550060004018061252542867"})
AADD(ADOCS,{"35121061365284012706550060004018112377608526"})
AADD(ADOCS,{"35121061365284012706550060004020071588529120"})
AADD(ADOCS,{"35121061365284012706550060004020081149722560"})
AADD(ADOCS,{"35121061365284012706550060004020401236268384"})
AADD(ADOCS,{"35121061365284012706550060004020631684074480"})
AADD(ADOCS,{"35121061365284012706550060004034341050434771"})
AADD(ADOCS,{"35121069278455000170550010000115261046403270"})
AADD(ADOCS,{"43121000218027000155550010000101431000524814"})
AADD(ADOCS,{"43121000218027000155550010000101431000524814"})


FOR _X := 1 TO LEN(ADOCS)
	_CCHAVE := ADOCS[_X][1]
	_CSERIE := SUBSTR(_CCHAVE,23,3)
	_CDOC := SUBSTR(_CCHAVE,26,9)
	_CCNPJ := SUBSTR(_CCHAVE,7,14)
	_CFORNECE := POSICIONE("SA2",3,XFILIAL("SA2")+_CCNPJ,"SA2->A2_COD")
	_CLOJA := SA2->A2_LOJA
	
	CQUERY1 := " UPDATE "+RETSQLNAME("SF1")+" SET F1_CHVNFE = '"+_CCHAVE+"' "
	CQUERY1 += " WHERE F1_FILIAL = '"+XFILIAL("SF1")+"' AND F1_DOC = '"+_CDOC+"' AND F1_SERIE = '"+_CSERIE+"' "
	CQUERY1 += " AND F1_FORNECE = '"+_CFORNECE+"' "
	CQUERY1 += " AND F1_LOJA = '"+_CLOJA+"' "
	CQUERY1 += " AND D_E_L_E_T_ <> '*'
	
	TCSQLEXEC(cQuery1)
	
	CQUERY2 := " UPDATE "+RETSQLNAME("SF3")+" SET F3_CHVNFE = '"+_CCHAVE+"' "
	CQUERY2 += " WHERE F3_FILIAL = '"+XFILIAL("SF3")+"' AND F3_NFISCAL = '"+_CDOC+"' AND F3_SERIE = '"+_CSERIE+"' "
	CQUERY2 += " AND F3_CLIEFOR = '"+_CFORNECE+"' "
	CQUERY2 += " AND F3_LOJA = '"+_CLOJA+"' "
	CQUERY2 += " AND D_E_L_E_T_ <> '*'
	
	TCSQLEXEC(cQuery2)
	
	
	CQUERY3 := " UPDATE "+RETSQLNAME("SFT")+" SET FT_CHVNFE = '"+_CCHAVE+"' "
	CQUERY3 += " WHERE FT_FILIAL = '"+XFILIAL("SFT")+"' AND FT_NFISCAL = '"+_CDOC+"' AND FT_SERIE = '"+_CSERIE+"' "
	CQUERY3 += " AND FT_CLIEFOR = '"+_CFORNECE+"' "
	CQUERY3 += " AND FT_LOJA = '"+_CLOJA+"' "
	CQUERY3 += " AND D_E_L_E_T_ <> '*'
	
	TCSQLEXEC(cQuery3)
	
NEXT _X

ALERT("CONCLUIDO")


RETURN()
